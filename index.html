<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Token Factory</title>

  <!-- estilos simples -->
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #000;
      color: white;
    }

    header {
      width: 100%;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: fixed;
      top: 0;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(6px);
      z-index: 100;
    }

    .logo {
      font-size: 28px;
      font-weight: bold;
      color: #ff0000;
    }

    .btn {
      padding: 10px 16px;
      border: none;
      cursor: pointer;
      font-size: 15px;
      border-radius: 6px;
      transition: 0.2s;
    }

    .btn-primary {
      background: #ff0000;
      color: white;
    }

    .btn-primary:hover {
      background: #cc0000;
    }

    .btn-error {
      background: #444;
      color: #ff0000;
      border: 1px solid #ff0000;
    }

    .btn-error:hover {
      background: #550000;
    }

    .main {
      margin-top: 150px;
      text-align: center;
      padding: 20px;
    }

    h1 {
      font-size: 50px;
      color: #ff0000;
    }

    p {
      font-size: 20px;
      margin-top: -10px;
      color: #ccc;
    }
  </style>
</head>

<body>

  <!-- HEADER -->
  <header>
    <div class="logo">TOKEN FACTORY</div>

    <!-- Bot√≥n de wallet -->
    <button 
      id="walletBtn"
      class="btn btn-primary"
      onclick="connectWallet()"
    >
      Conectar wallet
    </button>
  </header>

  <!-- CONTENIDO -->
  <div class="main">
    <h1>Crea tokens en Solana</h1>
    <p>Simple, r√°pido y en mainnet</p>

    <!-- bot√≥n de crear token (como lo ten√≠as antes) -->
    <button 
      class="btn btn-primary"
      onclick="location.href='/create'"
      style="margin-top:30px"
    >
      Crear token
    </button>
  </div>

  <!-- SCRIPT DE CONEXI√ìN WALLET -->
  <script>
    let walletConnected = false;

    // Detecta si Phantom est√° instalada y si ya estaba conectada antes
    document.addEventListener("DOMContentLoaded", async () => {
      const provider = window.solana;

      if (provider && provider.isPhantom) {
        try {
          const resp = await provider.connect({ onlyIfTrusted: true });

          if (resp.publicKey) {
            walletConnected = true;
            const btn = document.getElementById("walletBtn");
            btn.innerText = "Desconectar";
            btn.classList.remove("btn-primary");
            btn.classList.add("btn-error");
          }
        } catch (e) {
          // no estaba conectado antes
        }
      }
    });

    async function connectWallet() {
      const provider = window.solana;
      const btn = document.getElementById("walletBtn");

      try {
        if (!provider || !provider.isPhantom) {
          alert("Necesitas Phantom para usar esta funci√≥n.");
          return;
        }

        if (!walletConnected) {
          // conectar
          const resp = await provider.connect();
          walletConnected = true;

          alert("‚úÖ La wallet se conect√≥ correctamente");

          btn.innerText = "Desconectar";
          btn.classList.remove("btn-primary");
          btn.classList.add("btn-error");

        } else {
          // desconectar
          await provider.disconnect();
          walletConnected = false;

          alert("üîå Wallet desconectada");

          btn.innerText = "Conectar wallet";
          btn.classList.remove("btn-error");
          btn.classList.add("btn-primary");
        }

      } catch (err) {
        alert("‚ö†Ô∏è Error: " + err.message);
      }
    }
  </script>

</body>
</html>
